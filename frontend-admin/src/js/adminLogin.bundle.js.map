{"version":3,"sources":["webpack:///./js/page/adminLogin.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;;AAEA;AACA;AACA;;AAEA,cAAa;AACb;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA,0BAAyB;AACzB;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA,MAAK;;;AAGL;;;AAGA;;AAEA","file":"adminLogin.bundle.js","sourcesContent":["/**\n * Created by JinWYP on 24/10/2016.\n */\n\nvar avalon = require('avalon2') ;\n\nvar userService = require('../service/user.js') ;\nvar tokenService = require('../service/token.js') ;\n\n\nvar login = function() {\n\n    var vm = avalon.define({\n        $id: \"loginController\",\n        user : {\n            username : '',\n            email : '',\n            password : ''\n        },\n        errorMessage : {\n            inputUsername : '',\n            inputEmail : '',\n            inputPassword : '',\n            ajax : ''\n        },\n        successInputName : [],\n        errorInputName : [],\n        loginValidate : {\n            onSuccess : function (reasons){\n                if (vm.successInputName.indexOf(this.id) === -1) vm.successInputName.push(this.id.toString());\n                if (vm.errorInputName.indexOf(this.id) > -1) vm.errorInputName.splice(vm.errorInputName.indexOf(this.id),1);\n                console.log('有表单项通过')\n            },\n            onError: function (reasons) {\n\n                vm.errorMessage[this.id.toString()] = reasons[0].getMessage();\n\n                if (vm.successInputName.indexOf(this.id) > -1) vm.successInputName.splice(vm.successInputName.indexOf(this.id),1);\n                if (vm.errorInputName.indexOf(this.id.toString()) === -1) vm.errorInputName.push(this.id.toString());\n                console.log(vm.errorInputName)\n\n            },\n            onValidateAll: function (reasons) {\n                if (reasons.length) {\n                    console.log('有表单项没有通过')\n                } else {\n                    console.log('表单全部通过');\n\n                    userService.login({\n                        email : vm.user.email,\n                        password : vm.user.password\n                    }).done(function( data, textStatus, jqXHR ) {\n                        if (data.success){\n                            console.log('登录成功', data);\n\n                            tokenService.saveSessionInLocalStorage(data.data.token, data.data.data)\n                            window.location.href = '/warehouse/admin/home/finance'\n                        }else{\n                            vm.errorMessage.ajax = data.error.message;\n                        }\n                    }).fail(function( jqXHR, textStatus, errorThrown ) {\n                        var result = JSON.parse(jqXHR.responseText);\n                        console.error(result.error.message);\n                        vm.errorMessage.ajax = \"用户名或密码错误!\";\n                    });\n                }\n            }\n        }\n    });\n\n\n};\n\n\nlogin();\n\nmodule.exports = login;\n\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/page/adminLogin.js\n ** module id = 13\n ** module chunks = 2\n **/"],"sourceRoot":""}